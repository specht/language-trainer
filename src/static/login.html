<div class="container">

    <!-- Outer Row -->
    <div class="row justify-content-center">

        <div class="col-xl-8 col-lg-8 col-md-10 col-sm-12">

            <div class="card o-hidden border-0 shadow-lg">
                <div class="card-body py-4 px-5">
                    <!-- Nested Row within Card Body -->
                    <div class="row">
                        <!-- <div class="col-lg-6 d-none d-lg-block bg-login-image"></div> -->
                        <div class="col-lg-12">
                            <h2 style='margin-bottom: 30px;'>Anmeldung</h2>
                            <hr />
                            <form id='form' autocomplete='on'>
                                <div class="input-group mb-3">
                                    <input type="email" id='email' class="form-control"
                                        placeholder="Bitte gib deine E-Mail-Adresse ein" aria-label="E-Mail-Adresse"
                                        autocomplete='on'>
                                    <div class="input-group-append">
                                        <button id='submit' class="btn btn-primary" type="submit" disabled>Code
                                            zusenden</button>
                                    </div>
                                </div>
                            </form>
                            <div class='api_messages' style='display: none;'></div>
                            <hr />
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<script type='text/javascript'>

    function update_submit_button() {
        if ($('#email').val().trim().length > 0) {
            $('#submit').prop('disabled', false);
        } else {
            $('#submit').prop('disabled', true);
        }
    }
    
    window.addEventListener('load', function () {
        $('#form').submit(function(e) { e.preventDefault(); });
        $('#submit').click(function(e) {
            $('#email').prop('disabled', true);
            $('#submit').prop('disabled', true);
            api_call('/api/login', {email: $('#email').val()}, function(data) {
                if (data.success === true)
                    window.location.href = '/c/' + data.tag;
                else
                {
                    $('#email').prop('disabled', false);
                    $('#submit').prop('disabled', false);
                    if (data.error === 'no_invitation_found')
                        show_error_message('Mit dieser E-Mail-Adresse kannst du dich nicht anmelden. Bitte verwende deine Schul-E-Mail-Adresse.');
                    else
                        show_error_message('Bei der Anmeldung ist ein Fehler aufgetreten, bitte versuche es erneut.');
                }
            });
        });
        $('#email').focus();
        $('#email').keyup(function(e) {
            update_submit_button();
        });
        $('#email').change(function(e) {
            update_submit_button();
        });
    });
    </script>
    